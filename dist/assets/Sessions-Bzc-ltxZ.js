import{d as K,c as G,j as f,s as ot,r as T,u as Q,G as st,g as U,h as at}from"./index-SrrbdRdR.js";import{u as lt}from"./useSecureStorage-DJijK_j5.js";import{v as ct}from"./v4-BKrj-4V8.js";function ut(){const r=K(s=>s.sessions.filter),e=G(),i=["General","Technology","Science","Health","Business","Education","Entertainment","Politics"];return f.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:i.map(s=>f.jsx("button",{onClick:()=>e(ot(s)),className:`rounded px-3 py-1 text-sm border
                        ${r===s?"bg-blue-600 text-white":""}`,children:s},s))})}function E(){return E=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(r[s]=i[s])}return r},E.apply(null,arguments)}function $(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function k(r,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},k(r,e)}function dt(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,k(r,e)}var q=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function ht(r,e){return!!(r===e||q(r)&&q(e))}function ft(r,e){if(r.length!==e.length)return!1;for(var i=0;i<r.length;i++)if(!ht(r[i],e[i]))return!1;return!0}function L(r,e){e===void 0&&(e=ft);var i,s=[],d,v=!1;function w(){for(var S=[],b=0;b<arguments.length;b++)S[b]=arguments[b];return v&&i===this&&e(S,s)||(d=r.apply(this,S),v=!0,i=this,s=S),d}return w}var mt=typeof performance=="object"&&typeof performance.now=="function",H=mt?function(){return performance.now()}:function(){return Date.now()};function V(r){cancelAnimationFrame(r.id)}function pt(r,e){var i=H();function s(){H()-i>=e?r.call(null):d.id=requestAnimationFrame(s)}var d={id:requestAnimationFrame(s)};return d}var M=-1;function B(r){if(r===void 0&&(r=!1),M===-1||r){var e=document.createElement("div"),i=e.style;i.width="50px",i.height="50px",i.overflow="scroll",document.body.appendChild(e),M=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return M}var _=null;function J(r){if(r===void 0&&(r=!1),_===null||r){var e=document.createElement("div"),i=e.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";var s=document.createElement("div"),d=s.style;return d.width="100px",d.height="100px",e.appendChild(s),document.body.appendChild(e),e.scrollLeft>0?_="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?_="negative":_="positive-ascending"),document.body.removeChild(e),_}return _}var gt=150,vt=function(e,i){return e};function St(r){var e,i=r.getItemOffset,s=r.getEstimatedTotalSize,d=r.getItemSize,v=r.getOffsetForIndexAndAlignment,w=r.getStartIndexForOffset,S=r.getStopIndexForStartIndex,b=r.initInstanceProps,O=r.shouldResetStyleCacheOnItemSizeChange,c=r.validateProps;return e=function(y){dt(I,y);function I(m){var t;return t=y.call(this,m)||this,t._instanceProps=b(t.props,$(t)),t._outerRef=void 0,t._resetIsScrollingTimeoutId=null,t.state={instance:$(t),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof t.props.initialScrollOffset=="number"?t.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},t._callOnItemsRendered=void 0,t._callOnItemsRendered=L(function(n,o,a,u){return t.props.onItemsRendered({overscanStartIndex:n,overscanStopIndex:o,visibleStartIndex:a,visibleStopIndex:u})}),t._callOnScroll=void 0,t._callOnScroll=L(function(n,o,a){return t.props.onScroll({scrollDirection:n,scrollOffset:o,scrollUpdateWasRequested:a})}),t._getItemStyle=void 0,t._getItemStyle=function(n){var o=t.props,a=o.direction,u=o.itemSize,p=o.layout,l=t._getItemStyleCache(O&&u,O&&p,O&&a),h;if(l.hasOwnProperty(n))h=l[n];else{var g=i(t.props,n,t._instanceProps),z=d(t.props,n,t._instanceProps),C=a==="horizontal"||p==="horizontal",j=a==="rtl",R=C?g:0;l[n]=h={position:"absolute",left:j?void 0:R,right:j?R:void 0,top:C?0:g,height:C?"100%":z,width:C?z:"100%"}}return h},t._getItemStyleCache=void 0,t._getItemStyleCache=L(function(n,o,a){return{}}),t._onScrollHorizontal=function(n){var o=n.currentTarget,a=o.clientWidth,u=o.scrollLeft,p=o.scrollWidth;t.setState(function(l){if(l.scrollOffset===u)return null;var h=t.props.direction,g=u;if(h==="rtl")switch(J()){case"negative":g=-u;break;case"positive-descending":g=p-a-u;break}return g=Math.max(0,Math.min(g,p-a)),{isScrolling:!0,scrollDirection:l.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!1}},t._resetIsScrollingDebounced)},t._onScrollVertical=function(n){var o=n.currentTarget,a=o.clientHeight,u=o.scrollHeight,p=o.scrollTop;t.setState(function(l){if(l.scrollOffset===p)return null;var h=Math.max(0,Math.min(p,u-a));return{isScrolling:!0,scrollDirection:l.scrollOffset<h?"forward":"backward",scrollOffset:h,scrollUpdateWasRequested:!1}},t._resetIsScrollingDebounced)},t._outerRefSetter=function(n){var o=t.props.outerRef;t._outerRef=n,typeof o=="function"?o(n):o!=null&&typeof o=="object"&&o.hasOwnProperty("current")&&(o.current=n)},t._resetIsScrollingDebounced=function(){t._resetIsScrollingTimeoutId!==null&&V(t._resetIsScrollingTimeoutId),t._resetIsScrollingTimeoutId=pt(t._resetIsScrolling,gt)},t._resetIsScrolling=function(){t._resetIsScrollingTimeoutId=null,t.setState({isScrolling:!1},function(){t._getItemStyleCache(-1,null)})},t}I.getDerivedStateFromProps=function(t,n){return xt(t,n),c(t),null};var x=I.prototype;return x.scrollTo=function(t){t=Math.max(0,t),this.setState(function(n){return n.scrollOffset===t?null:{scrollDirection:n.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},x.scrollToItem=function(t,n){n===void 0&&(n="auto");var o=this.props,a=o.itemCount,u=o.layout,p=this.state.scrollOffset;t=Math.max(0,Math.min(t,a-1));var l=0;if(this._outerRef){var h=this._outerRef;u==="vertical"?l=h.scrollWidth>h.clientWidth?B():0:l=h.scrollHeight>h.clientHeight?B():0}this.scrollTo(v(this.props,t,n,p,this._instanceProps,l))},x.componentDidMount=function(){var t=this.props,n=t.direction,o=t.initialScrollOffset,a=t.layout;if(typeof o=="number"&&this._outerRef!=null){var u=this._outerRef;n==="horizontal"||a==="horizontal"?u.scrollLeft=o:u.scrollTop=o}this._callPropsCallbacks()},x.componentDidUpdate=function(){var t=this.props,n=t.direction,o=t.layout,a=this.state,u=a.scrollOffset,p=a.scrollUpdateWasRequested;if(p&&this._outerRef!=null){var l=this._outerRef;if(n==="horizontal"||o==="horizontal")if(n==="rtl")switch(J()){case"negative":l.scrollLeft=-u;break;case"positive-ascending":l.scrollLeft=u;break;default:var h=l.clientWidth,g=l.scrollWidth;l.scrollLeft=g-h-u;break}else l.scrollLeft=u;else l.scrollTop=u}this._callPropsCallbacks()},x.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&V(this._resetIsScrollingTimeoutId)},x.render=function(){var t=this.props,n=t.children,o=t.className,a=t.direction,u=t.height,p=t.innerRef,l=t.innerElementType,h=t.innerTagName,g=t.itemCount,z=t.itemData,C=t.itemKey,j=C===void 0?vt:C,R=t.layout,X=t.outerElementType,Y=t.outerTagName,Z=t.style,tt=t.useIsScrolling,et=t.width,F=this.state.isScrolling,P=a==="horizontal"||R==="horizontal",rt=P?this._onScrollHorizontal:this._onScrollVertical,W=this._getRangeToRender(),it=W[0],nt=W[1],D=[];if(g>0)for(var N=it;N<=nt;N++)D.push(T.createElement(n,{data:z,key:j(N,z),index:N,isScrolling:tt?F:void 0,style:this._getItemStyle(N)}));var A=s(this.props,this._instanceProps);return T.createElement(X||Y||"div",{className:o,onScroll:rt,ref:this._outerRefSetter,style:E({position:"relative",height:u,width:et,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},Z)},T.createElement(l||h||"div",{children:D,ref:p,style:{height:P?"100%":A,pointerEvents:F?"none":void 0,width:P?A:"100%"}}))},x._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var t=this.props.itemCount;if(t>0){var n=this._getRangeToRender(),o=n[0],a=n[1],u=n[2],p=n[3];this._callOnItemsRendered(o,a,u,p)}}if(typeof this.props.onScroll=="function"){var l=this.state,h=l.scrollDirection,g=l.scrollOffset,z=l.scrollUpdateWasRequested;this._callOnScroll(h,g,z)}},x._getRangeToRender=function(){var t=this.props,n=t.itemCount,o=t.overscanCount,a=this.state,u=a.isScrolling,p=a.scrollDirection,l=a.scrollOffset;if(n===0)return[0,0,0,0];var h=w(this.props,l,this._instanceProps),g=S(this.props,h,l,this._instanceProps),z=!u||p==="backward"?Math.max(1,o):1,C=!u||p==="forward"?Math.max(1,o):1;return[Math.max(0,h-z),Math.max(0,Math.min(n-1,g+C)),h,g]},I}(T.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var xt=function(e,i){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,i.instance},yt=St({getItemOffset:function(e,i){var s=e.itemSize;return i*s},getItemSize:function(e,i){var s=e.itemSize;return s},getEstimatedTotalSize:function(e){var i=e.itemCount,s=e.itemSize;return s*i},getOffsetForIndexAndAlignment:function(e,i,s,d,v,w){var S=e.direction,b=e.height,O=e.itemCount,c=e.itemSize,y=e.layout,I=e.width,x=S==="horizontal"||y==="horizontal",m=x?I:b,t=Math.max(0,O*c-m),n=Math.min(t,i*c),o=Math.max(0,i*c-m+c+w);switch(s==="smart"&&(d>=o-m&&d<=n+m?s="auto":s="center"),s){case"start":return n;case"end":return o;case"center":{var a=Math.round(o+(n-o)/2);return a<Math.ceil(m/2)?0:a>t+Math.floor(m/2)?t:a}case"auto":default:return d>=o&&d<=n?d:d<o?o:n}},getStartIndexForOffset:function(e,i){var s=e.itemCount,d=e.itemSize;return Math.max(0,Math.min(s-1,Math.floor(i/d)))},getStopIndexForStartIndex:function(e,i,s){var d=e.direction,v=e.height,w=e.itemCount,S=e.itemSize,b=e.layout,O=e.width,c=d==="horizontal"||b==="horizontal",y=i*S,I=c?O:v,x=Math.ceil((I+s-y)/S);return Math.max(0,Math.min(w-1,i+x-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function It({data:r,index:e,style:i}){const{items:s,navigate:d}=r,v=s[e];return f.jsxs("div",{style:i,onClick:()=>d(`/chat/${v.id}`),className:`cursor-point border-b p-3 hover:bg-gray-100 \r
                        dark:hover:bg-gray-800`,children:[f.jsx("h3",{className:"truncate font-medium",children:v.title}),f.jsx("p",{className:"line-clamp-1 text-xs text-gray-500",children:v.summary}),f.jsx("span",{className:"text-[10px] opacity-60",children:v.tag})]})}const bt=T.memo(function({sessions:e}){const i=Q();return f.jsx(yt,{height:560,itemCount:e.length,itemSize:78,width:"100%",itemData:{items:e,navigate:i},children:It})});function wt(r){return st({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM216 232l0 102.1 31-31c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-72 72c-9.4 9.4-24.6 9.4-33.9 0l-72-72c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l31 31L168 232c0-13.3 10.7-24 24-24s24 10.7 24 24z"},child:[]}]})(r)}function Tt(){const{list:r,filter:e}=K(c=>c.sessions),i=G(),s=Q(),[d,v]=lt("insights-sessions",[]);T.useEffect(()=>{d.forEach(c=>{r.some(I=>I.id===c.id)||i(U(c))})},[]);const w=T.useRef(!0);T.useEffect(()=>{if(w.current){w.current=!1;return}v(r)},[r]);const S=r.filter(c=>e==="ALL"||c.tag===e),b=()=>{const c=new Blob([JSON.stringify({sessions:r})],{type:"application/json"}),y=URL.createObjectURL(c);Object.assign(document.createElement("a"),{href:y,download:`insights-${ct()}.json`}).click(),URL.revokeObjectURL(y)},O=c=>{const y=c.target.files?.[0];if(!y)return;const I=new FileReader;I.onload=x=>{try{const{sessions:m}=JSON.parse(x.target.result);v(m),window.location.reload()}catch{alert("Invalid JSON")}},I.readAsText(y)};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"mb-4 flex flex-wrap items-center justify-between",children:f.jsxs("div",{className:"flex gap-3 mr-8",children:[f.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded border px-4 py-3 text-sm shadow",children:[f.jsx(wt,{className:"text-base"})," Import",f.jsx("input",{hidden:!0,type:"file",accept:"application/json",onChange:O})]}),f.jsxs("button",{onClick:b,className:" flex cursor-pointer items-center gap-2 rounded border px-3 py-2 text-sm shadow",children:[f.jsx(at,{className:"text-base"})," Export"]}),f.jsx("button",{className:"rounded bg-blue-600 px-3 py-2 text-white shadow shadow",onClick:()=>{const c=U();i(c),s(`/chat/${c.payload.id}`)},children:"+ New Chat"})]})}),f.jsx(ut,{}),S.length>100?f.jsx(bt,{sessions:S}):f.jsx("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:S.map(c=>f.jsxs("div",{onClick:()=>s(`/chat/${c.id}`),className:`cursor-pointer rounded border p-4 shadow\r
                         transition hover:bg-gray-50 dark:hover:bg-gray-800`,children:[f.jsx("h3",{className:"truncate font-semibold",children:c.title}),f.jsx("p",{className:"line-clamp-2 text-xs text-gray-500",children:c.summary}),f.jsx("span",{className:"text-[10px] opacity-60",children:c.tag})]},c.id))})]})}export{Tt as default};
